53*0.8+65*0.2
x <- data.frame(x=rnorm(100), y=factor(sample(c('a','b','c'), size=100, replace=T)))
x <- data.frame(x=rnorm(100), y=factor(sample(c('a','b','c'), size=100, replace=T)), z=rnorm(100))
full <- lm(z~x+y)
full <- lm(z~x+y,data=x)
base <- lm(z~x, data=x)
anova(full,base)
y <- rnorm(100,mean=0.1, sd=0.01)
sd(c(x,y))
x <- rnorm(100,mean=0, sd=0.01)
x <- rnorm(100,mean=0.0, sd=0.01)
y <- rnorm(100,mean=0.1, sd=0.01)
sd(c(x,y))
sd(c(rep(0,100), rep(0.05,100))
)
sd(c(rep(0,100), rep(0.1,100)))
sd(c(rep(0,100), rep(0.025,100)))
binom.test(x=7,p=0.5,n=10,alternative="greater")
binom.test(x=7,p=0.5,n=10,alternative="greater")
binom.test(x=5,p=0.5,n=10,alternative="greater")
binom.test(x=10,p=0.5,n=10,alternative="greater")
binom.test(x=7,p=0.5,n=10,alternative="greater")
binom.test(x=4,p=0.5,n=10,alternative="greater")
binom.test(x=1,p=0.5,n=10,alternative="greater")
binom.test(x=9,p=0.5,n=10,alternative="greater")
x <- "Josine L Min1,2*, Gibran Hemani1,2*, Eilis Hannon3, Koen F Dekkers4, Juan Castillo-Fernandez5, René Luijk4, Elena Carnero-Montoro5,6, Daniel J Lawson1,2, Kimberley Burrows1,2, Matthew Suderman1,2, Andrew D Bretherick7, Tom G Richardson1,2, Johanna Klughammer8, Valentina Iotchkova9, Gemma Sharp1,2, Ahmad Al Khleifat10, Aleksey Shatunov10, Alfredo Iacoangeli10,11, Wendy L McArdle2, Karen M Ho2, Ashish Kumar12,13,14, Cilla Söderhäll15, Carolina Soriano-Tárraga16, Eva Giralt-Steinhauer16, Nabila Kazmi1,2, Dan Mason17, Allan F McRae18, David L Corcoran19, Karen Sugden19,20, Silva Kasela21, Alexia Cardona22,23, Felix R Day22, Giovanni Cugliari24,25, Clara Viberti24,25, Simonetta Guarrera24,25, Michael Lerro26, Richa Gupta27,28, Sailalitha Bollepalli27,28, Pooja Mandaviya29, Yanni Zeng7,30,31, Toni-Kim Clarke32, Rosie M Walker33,34, Vanessa Schmoll35, Darina Czamara35, Carlos Ruiz-Arenas36,37,38, Faisal I Rezwan39 , Riccardo E Marioni33,34,40, Tian Lin18, Yvonne Awaloff35, Marine Germain401, Dylan Aïssi412, Ramona Zwamborn423, Kristel van Eijk423, Annelot Dekker423, Jenny van Dongen434, Jouke-Jan Hottenga434, Gonneke Willemsen434, Cheng-Jian Xu44,45 , Guillermo Barturen6, Francesc Català-Moll46, Martin Kerick47, Carol Wang48, Phillip Melton49, Hannah R Elliott1,2, Jean Shin50,51, Manon Bernard50, Idil Yet5,51, Melissa Smart52, Tyler Gorrie-Stone52, BIOS Consortiumxx, Chris Shaw10,53, Ammar Al Chalabi10,53,54, Susan M Ring1,2, Göran Pershagen12, Erik Melén12,55, Jordi Jiménez-Conde16, Jaume Roquer16, Debbie Deborah A Lawlor1,2, John Wright17, Nicholas G Martin56, Grant W Montgomery18, Terrie E Moffitt19,20,57,60, Richie Poulton58, Tõnu Esko21,59, Lili Milani21, Andres Metspalu21, John RB Perry22, Ken K Ong22, Nicholas J Wareham22, Giuseppe Matullo24,25, Carlotta Sacerdote25,61, Salvatore Panico62, Avshalom Caspi19,20,57,60, Louise Arseneault60, France Gagnon26, Miina Ollikainen27,28, Jaakko Kaprio27,28, Janine F Felix63,64,645, Fernando Rivadeneira29, Henning Tiemeier656,667, Marinus H van IJzendoorn 678,689, André G Uitterlinden29, Vincent WV Jaddoe63,64,6457, Chris Haley7, Andrew M McIntosh32,34, Kathryn L Evans33,34, Alison Murray6970, Katri Räikkönen701, Jari Lahti701, Ellen A Nohr712,723, Thorkild IA Sørensen1,2,734,745, Torben Hansen734, Camilla Schmidt Morgen756, Elisabeth B Binder35,767, Susanne Lucae35, Juan Ramon Gonzalez36,37,38, Mariona Bustamante36,37,38,778, Jordi Sunyer36,37,38,789, John W Holloway739,80, Wilfried Karmaus81, Hongmei Zhang81, Ian J Deary34, Naomi R Wray18,82, John M Starr34,83, Marian Beekman4, Diana van Heemst84, P Eline Slagboom4, Pierre-Emmanuel Morange85, David-Alexandre Trégouët41, Jan H Veldink43, Gareth E Davies86, Eco JC de Geus44, Dorret I Boomsma44, Judith M Vonk87, Bert Brunekreef88,89, Gerard H Koppelman45, Marta E Alarcón-Riquelme6,12, Rae-Chi Huang90, Craig Pennell48, Joyce van Meurs29, M Arfan Ikram9164, Alun D Hughes921, Therese Tillin921, Nish Chaturvedi921, Zdenka Pausova5049, Tomas Paus932, Timothy D Spector5, Meena Kumari52, Leonard C Schalkwyk52, Peter M Visscher18,82, George Davey Smith1,2, Christoph Bock8,94, Tom R Gaunt1,2, Jordana T Bell5‡, Bastiaan T Heijmans4‡, Jonathan Mill3‡, Caroline L Relton1,2‡"
power.t.test(n=50, sd=0.1, power=0.8)
power.t.test(n=50, sd=0.1, power=0.8, alpha=0.05/850000)
power.t.test(n=50, sd=0.1, power=0.8, sig.level=0.05/850000)
power.t.test(n=20, sd=0.1, power=0.8, sig.level=0.05)
power.t.test(n=20, sd=0.1, power=0.8, sig.level=0.05/850000)
power.t.test(n=10, sd=0.1, power=0.8, sig.level=0.05)
power.t.test(n=10, sd=0.1, power=0.8, sig.level=0.05/850000)
24*0.1
24*0.131
12*0.1
0.1*8
p.adjust(c(.693,0.38,0.237,0.242,0.74,0.131,0.350,0.119, 0.838,0.231,0.042, 0.642,0.559,0.222,0.953,0.532,0.821,0.086,0.809,0.0999,0.639,0.031,0.352,0.106),"fdr")
sort(p.adjust(c(.693,0.38,0.237,0.242,0.74,0.131,0.350,0.119, 0.838,0.231,0.042, 0.642,0.559,0.222,0.953,0.532,0.821,0.086,0.809,0.0999,0.639,0.031,0.352,0.106),"fdr"))
hist(c(.693,0.38,0.237,0.242,0.74,0.131,0.350,0.119, 0.838,0.231,0.042, 0.642,0.559,0.222,0.953,0.532,0.821,0.086,0.809,0.0999,0.639,0.031,0.352,0.106))
plot(density(c(.693,0.38,0.237,0.242,0.74,0.131,0.350,0.119, 0.838,0.231,0.042, 0.642,0.559,0.222,0.953,0.532,0.821,0.086,0.809,0.0999,0.639,0.031,0.352,0.106)))
hist(c(.693,0.38,0.237,0.242,0.74,0.131,0.350,0.119, 0.838,0.231,0.042, 0.642,0.559,0.222,0.953,0.532,0.821,0.086,0.809,0.0999,0.639,0.031,0.352,0.106), breaks=seq(0,1,0.05))
hist(c(.693,0.38,0.237,0.242,0.74,0.131,0.350,0.119, 0.838,0.231,0.042, 0.642,0.559,0.222,0.953,0.532,0.821,0.086,0.809,0.0999,0.639,0.031,0.352,0.106), breaks=seq(0,1,length.out=24))
hist(c(.693,0.38,0.237,0.242,0.74,0.131,0.350,0.119, 0.838,0.231,0.042, 0.642,0.559,0.222,0.953,0.532,0.821,0.086,0.809,0.0999,0.639,0.031,0.352,0.106), breaks=seq(0,1,length.out=10))
hist(c(.693,0.38,0.237,0.242,0.74,0.131,0.350,0.119, 0.838,0.231,0.042, 0.642,0.559,0.222,0.953,0.532,0.821,0.086,0.809,0.0999,0.639,0.031,0.352,0.106), breaks=seq(0,1,length.out=20))
library(meffil)
q()
library(pROC)
data(aSAH)
roc.s100b <- roc(aSAH$outcome, aSAH$s100b)
plot(roc.s100b)
as <- aSAH
as[1,]
dim(as)
cor(as$outcome, as$s100b)
dat <- as[1:20,]
plot(roc(as$outcome, as$s100b))
plot(roc(as$outcome, as$s100b))
dat <- as[1:20,]
plot(roc(dat$outcome, dat$s100b))
dat <- as[1:10,]
plot(roc(dat$outcome, dat$s100b))
dat <- as[1:5,]
plot(roc(dat$outcome, dat$s100b))
dat <- as[1:10,]
plot(roc(dat$outcome, dat$s100b))
dat <- as[1:20,]
plot(roc(dat$outcome, dat$s100b))
dat <- as[1:15,]
plot(roc(dat$outcome, dat$s100b))
dat <- as[1:10,]
plot(roc(dat$outcome, dat$s100b))
dat <- as[1:40,]
plot(roc(dat$outcome, dat$s100b))
dat <- as[1:10,]
plot(roc(dat$outcome, dat$s100b))
dat <- as[1:15,]
plot(roc(dat$outcome, dat$s100b))
x <- matrix(rnorm(1000), ncol=10)
y <- prcomp(x)
dim(y$x)
y$x[1:5,]
colVars(y$x)
apply(y$x, 2, var)
names(y)
y$sdev
apply(y$x, 2, sd)
sum(y$sdev^2)
sum(y$sdev)
sum(sqrt(y$sdev))
v <- apply(y$x, 2, var)
v/sum(v)
sum(v/sum(v))
y <- c(270,405)
n <- c(38,58)
lm(y~n)
coef(summary(lm(y~n)))
13.50 + 38*6.75
13.50 + 58*6.75
n <- c(38,68)
coef(summary(lm(y~n)))
38/270
270/38
405/58
setwd("~/GitHub/epigenetics-journal-club/docs/presentations/20210308")
x <- read.csv("ewas.csv")
x[1,]
colnames(x)
colnames(x)[1] <- "pmid"
x[1,]
x <- x[,1:8]
x[1,]
library(knitr)
kable(x)
